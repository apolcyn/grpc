resolver_tests_common_zone_name: resolver-tests-version-4.grpctestingexp.
resolver_component_tests:
# Tests for which we enable SRV queries
- expected_addrs:
  - {address: '5.5.5.5:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: no-srv-ipv4-single-target
  records:
    no-srv-ipv4-single-target:
    - {TTL: '2100', data: 5.5.5.5, type: A}
- expected_addrs:
  - {address: '1.2.3.4:1234', is_balancer: true}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv4-single-target
  records:
    _grpclb._tcp.srv-ipv4-single-target:
    - {TTL: '2100', data: 0 0 1234 ipv4-single-target, type: SRV}
    ipv4-single-target:
    - {TTL: '2100', data: 1.2.3.4, type: A}
- expected_addrs:
  - {address: '1.2.3.5:1234', is_balancer: true}
  - {address: '1.2.3.6:1234', is_balancer: true}
  - {address: '1.2.3.7:1234', is_balancer: true}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv4-multi-target
  records:
    _grpclb._tcp.srv-ipv4-multi-target:
    - {TTL: '2100', data: 0 0 1234 ipv4-multi-target, type: SRV}
    ipv4-multi-target:
    - {TTL: '2100', data: 1.2.3.5, type: A}
    - {TTL: '2100', data: 1.2.3.6, type: A}
    - {TTL: '2100', data: 1.2.3.7, type: A}
- expected_addrs:
  - {address: '[2607:f8b0:400a:801::1001]:1234', is_balancer: true}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv6-single-target
  records:
    _grpclb._tcp.srv-ipv6-single-target:
    - {TTL: '2100', data: 0 0 1234 ipv6-single-target, type: SRV}
    ipv6-single-target:
    - {TTL: '2100', data: '2607:f8b0:400a:801::1001', type: AAAA}
- expected_addrs:
  - {address: '[2607:f8b0:400a:801::1002]:1234', is_balancer: true}
  - {address: '[2607:f8b0:400a:801::1003]:1234', is_balancer: true}
  - {address: '[2607:f8b0:400a:801::1004]:1234', is_balancer: true}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv6-multi-target
  records:
    _grpclb._tcp.srv-ipv6-multi-target:
    - {TTL: '2100', data: 0 0 1234 ipv6-multi-target, type: SRV}
    ipv6-multi-target:
    - {TTL: '2100', data: '2607:f8b0:400a:801::1002', type: AAAA}
    - {TTL: '2100', data: '2607:f8b0:400a:801::1003', type: AAAA}
    - {TTL: '2100', data: '2607:f8b0:400a:801::1004', type: AAAA}
- expected_addrs:
  - {address: '1.2.3.4:1234', is_balancer: true}
  expected_chosen_service_config: '{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"SimpleService"}],"waitForReady":true}]}'
  expected_service_config_error: null
  expected_lb_policy: round_robin
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv4-simple-service-config
  records:
    _grpclb._tcp.srv-ipv4-simple-service-config:
    - {TTL: '2100', data: 0 0 1234 ipv4-simple-service-config, type: SRV}
    ipv4-simple-service-config:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.srv-ipv4-simple-service-config:
    - {TTL: '2100', data: 'grpc_config=[{"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"SimpleService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: '{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"NoSrvSimpleService"}],"waitForReady":true}]}'
  expected_service_config_error: null
  expected_lb_policy: round_robin
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-no-srv-simple-service-config
  records:
    ipv4-no-srv-simple-service-config:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-no-srv-simple-service-config:
    - {TTL: '2100', data: 'grpc_config=[{"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"NoSrvSimpleService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-no-config-for-cpp
  records:
    ipv4-no-config-for-cpp:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-no-config-for-cpp:
    - {TTL: '2100', data: 'grpc_config=[{"clientLanguage":["python"],"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"PythonService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-cpp-config-has-zero-percentage
  records:
    ipv4-cpp-config-has-zero-percentage:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-cpp-config-has-zero-percentage:
    - {TTL: '2100', data: 'grpc_config=[{"percentage":0,"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"CppService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: '{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"CppService"}],"waitForReady":true}]}'
  expected_service_config_error: null
  expected_lb_policy: round_robin
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-second-language-is-cpp
  records:
    ipv4-second-language-is-cpp:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-second-language-is-cpp:
    - {TTL: '2100', data: 'grpc_config=[{"clientLanguage":["go"],"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"GoService"}],"waitForReady":true}]}},{"clientLanguage":["c++"],"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"CppService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: '{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"AlwaysPickedService"}],"waitForReady":true}]}'
  expected_service_config_error: null
  expected_lb_policy: round_robin
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-config-with-percentages
  records:
    ipv4-config-with-percentages:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-config-with-percentages:
    - {TTL: '2100', data: 'grpc_config=[{"percentage":0,"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"NeverPickedService"}],"waitForReady":true}]}},{"percentage":100,"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"AlwaysPickedService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:1234', is_balancer: true}
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv4-target-has-backend-and-balancer
  records:
    _grpclb._tcp.srv-ipv4-target-has-backend-and-balancer:
    - {TTL: '2100', data: 0 0 1234 balancer-for-ipv4-has-backend-and-balancer, type: SRV}
    balancer-for-ipv4-has-backend-and-balancer:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    srv-ipv4-target-has-backend-and-balancer:
    - {TTL: '2100', data: 1.2.3.4, type: A}
- expected_addrs:
  - {address: '[2607:f8b0:400a:801::1002]:1234', is_balancer: true}
  - {address: '[2607:f8b0:400a:801::1002]:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv6-target-has-backend-and-balancer
  records:
    _grpclb._tcp.srv-ipv6-target-has-backend-and-balancer:
    - {TTL: '2100', data: 0 0 1234 balancer-for-ipv6-has-backend-and-balancer, type: SRV}
    balancer-for-ipv6-has-backend-and-balancer:
    - {TTL: '2100', data: '2607:f8b0:400a:801::1002', type: AAAA}
    srv-ipv6-target-has-backend-and-balancer:
    - {TTL: '2100', data: '2607:f8b0:400a:801::1002', type: AAAA}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: '{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooTwo","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooThree","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooFour","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooFive","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooSix","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooSeven","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooEight","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooNine","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooTen","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooEleven","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooTwelve","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooTwelve","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooTwelve","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooTwelve","service":"SimpleService"}],"waitForReady":true}]}'
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-config-causing-fallback-to-tcp
  records:
    ipv4-config-causing-fallback-to-tcp:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-config-causing-fallback-to-tcp:
    - {TTL: '2100', data: 'grpc_config=[{"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooTwo","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooThree","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooFour","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooFive","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooSix","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooSeven","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooEight","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooNine","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooTen","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooEleven","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooTwelve","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooTwelve","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooTwelve","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"FooTwelve","service":"SimpleService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: '{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo_0","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_1","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_2","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_3","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_4","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_5","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_6","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_7","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_8","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_9","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_10","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_11","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_12","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_13","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_14","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_15","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_16","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_17","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_18","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_19","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_20","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_21","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_22","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_23","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_24","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_25","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_26","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_27","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_28","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_29","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_30","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_31","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_32","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_33","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_34","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_35","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_36","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_37","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_38","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_39","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_40","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_41","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_42","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_43","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_44","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_45","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_46","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_47","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_48","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_49","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_50","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_51","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_52","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_53","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_54","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_55","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_56","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_57","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_58","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_59","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_60","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_61","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_62","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_63","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_64","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_65","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_66","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_67","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_68","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_69","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_70","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_71","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_72","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_73","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_74","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_75","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_76","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_77","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_78","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_79","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_80","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_81","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_82","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_83","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_84","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_85","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_86","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_87","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_88","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_89","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_90","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_91","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_92","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_93","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_94","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_95","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_96","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_97","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_98","service":"SimpleService"}],"waitForReady":true},{"name":[{"method":"Foo_99","service":"SimpleService"}],"waitForReady":true}]}'
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-8k-service-config
  records:
    ipv4-8k-service-config:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-8k-service-config:
    - {TTL: '2100', data: 'grpc_config=[{"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig": [{"name": [{"method": "Foo_0", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_1", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_2", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_3", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_4", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_5", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_6", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_7", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_8", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_9", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_10", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_11", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_12", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_13", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_14", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_15", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_16", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_17", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_18", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_19", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_20", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_21", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_22", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_23", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_24", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_25", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_26", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_27", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_28", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_29", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_30", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_31", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_32", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_33", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_34", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_35", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_36", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_37", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_38", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_39", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_40", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_41", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_42", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_43", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_44", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_45", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_46", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_47", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_48", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_49", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_50", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_51", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_52", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_53", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_54", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_55", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_56", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_57", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_58", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_59", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_60", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_61", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_62", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_63", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_64", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_65", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_66", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_67", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_68", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_69", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_70", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_71", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_72", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_73", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_74", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_75", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_76", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_77", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_78", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_79", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_80", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_81", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_82", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_83", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_84", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_85", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_86", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_87", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_88", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_89", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_90", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_91", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_92", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_93", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_94", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_95", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_96", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_97", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_98", "service": "SimpleService"}], "waitForReady": true}, {"name": [{"method": "Foo_99", "service": "SimpleService"}], "waitForReady": true}]}}]',
      type: TXT}
# Tests for which we don't enable SRV queries
- expected_addrs:
  - {address: '2.3.4.5:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: false
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv4-single-target-srv-disabled
  records:
    _grpclb._tcp.srv-ipv4-single-target-srv-disabled:
    - {TTL: '2100', data: 0 0 1234 ipv4-single-target-srv-disabled, type: SRV}
    ipv4-single-target-srv-disabled:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    srv-ipv4-single-target-srv-disabled:
    - {TTL: '2100', data: 2.3.4.5, type: A}
- expected_addrs:
  - {address: '9.2.3.5:443', is_balancer: false}
  - {address: '9.2.3.6:443', is_balancer: false}
  - {address: '9.2.3.7:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: false
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv4-multi-target-srv-disabled
  records:
    _grpclb._tcp.srv-ipv4-multi-target-srv-disabled:
    - {TTL: '2100', data: 0 0 1234 ipv4-multi-target-srv-disabled, type: SRV}
    ipv4-multi-target-srv-disabled:
    - {TTL: '2100', data: 1.2.3.5, type: A}
    - {TTL: '2100', data: 1.2.3.6, type: A}
    - {TTL: '2100', data: 1.2.3.7, type: A}
    srv-ipv4-multi-target-srv-disabled:
    - {TTL: '2100', data: 9.2.3.5, type: A}
    - {TTL: '2100', data: 9.2.3.6, type: A}
    - {TTL: '2100', data: 9.2.3.7, type: A}
- expected_addrs:
  - {address: '[2600::1001]:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: false
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv6-single-target-srv-disabled
  records:
    _grpclb._tcp.srv-ipv6-single-target-srv-disabled:
    - {TTL: '2100', data: 0 0 1234 ipv6-single-target-srv-disabled, type: SRV}
    ipv6-single-target-srv-disabled:
    - {TTL: '2100', data: '2607:f8b0:400a:801::1001', type: AAAA}
    srv-ipv6-single-target-srv-disabled:
    - {TTL: '2100', data: '2600::1001', type: AAAA}
- expected_addrs:
  - {address: '[2600::1002]:443', is_balancer: false}
  - {address: '[2600::1003]:443', is_balancer: false}
  - {address: '[2600::1004]:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: false
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv6-multi-target-srv-disabled
  records:
    _grpclb._tcp.srv-ipv6-multi-target-srv-disabled:
    - {TTL: '2100', data: 0 0 1234 ipv6-multi-target-srv-disabled, type: SRV}
    ipv6-multi-target-srv-disabled:
    - {TTL: '2100', data: '2607:f8b0:400a:801::1002', type: AAAA}
    - {TTL: '2100', data: '2607:f8b0:400a:801::1003', type: AAAA}
    - {TTL: '2100', data: '2607:f8b0:400a:801::1004', type: AAAA}
    srv-ipv6-multi-target-srv-disabled:
    - {TTL: '2100', data: '2600::1002', type: AAAA}
    - {TTL: '2100', data: '2600::1003', type: AAAA}
    - {TTL: '2100', data: '2600::1004', type: AAAA}
- expected_addrs:
  - {address: '5.5.3.4:443', is_balancer: false}
  expected_chosen_service_config: '{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"SimpleService"}],"waitForReady":true}]}'
  expected_service_config_error: null
  expected_lb_policy: round_robin
  enable_srv_queries: false
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv4-simple-service-config-srv-disabled
  records:
    _grpclb._tcp.srv-ipv4-simple-service-config-srv-disabled:
    - {TTL: '2100', data: 0 0 1234 ipv4-simple-service-config-srv-disabled, type: SRV}
    ipv4-simple-service-config-srv-disabled:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    srv-ipv4-simple-service-config-srv-disabled:
    - {TTL: '2100', data: 5.5.3.4, type: A}
    _grpc_config.srv-ipv4-simple-service-config-srv-disabled:
    - {TTL: '2100', data: 'grpc_config=[{"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"SimpleService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:1234', is_balancer: true}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: false
  inject_broken_nameserver_list: false
  record_to_resolve: srv-ipv4-simple-service-config-txt-disabled
  records:
    _grpclb._tcp.srv-ipv4-simple-service-config-txt-disabled:
    - {TTL: '2100', data: 0 0 1234 ipv4-simple-service-config-txt-disabled, type: SRV}
    ipv4-simple-service-config-txt-disabled:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.srv-ipv4-simple-service-config-txt-disabled:
    - {TTL: '2100', data: 'grpc_config=[{"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"SimpleService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: false
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-cpp-config-has-zero-percentage-txt-disabled
  records:
    ipv4-cpp-config-has-zero-percentage-txt-disabled:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-cpp-config-has-zero-percentage-txt-disabled:
    - {TTL: '2100', data: 'grpc_config=[{"percentage":0,"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"CppService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: false
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-second-language-is-cpp-txt-disabled
  records:
    ipv4-second-language-is-cpp-txt-disabled:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-second-language-is-cpp-txt-disabled:
    - {TTL: '2100', data: 'grpc_config=[{"clientLanguage":["go"],"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"GoService"}],"waitForReady":true}]}},{"clientLanguage":["c++"],"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"CppService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: 'could not parse'
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-svc_cfg_bad_json
  records:
    ipv4-svc_cfg_bad_json:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-svc_cfg_bad_json:
    - {TTL: '2100', data: 'grpc_config=[{]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: 'field:clientLanguage error:should be of type array'
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-svc_cfg_bad_client_language
  records:
    ipv4-svc_cfg_bad_client_language:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-svc_cfg_bad_client_language:
    - {TTL: '2100', data: 'grpc_config=[{"clientLanguage":"go","serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"GoService"}],"waitForReady":true}]}},{"clientLanguage":["c++"],"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"CppService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: 'field:percentage error:should be of type number'
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-svc_cfg_bad_percentage
  records:
    ipv4-svc_cfg_bad_percentage:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-svc_cfg_bad_percentage:
    - {TTL: '2100', data: 'grpc_config=[{"percentage":"0","serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"GoService"}],"waitForReady":true}]}},{"clientLanguage":["c++"],"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"CppService"}],"waitForReady":true}]}}]',
      type: TXT}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: 'field:waitForReady error:Type should be true/false'
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: false
  record_to_resolve: ipv4-svc_cfg_bad_wait_for_ready
  records:
    ipv4-svc_cfg_bad_wait_for_ready:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-svc_cfg_bad_wait_for_ready:
    - {TTL: '2100', data: 'grpc_config=[{"serviceConfig":{"methodConfig":[{"name":[{"method":"Foo","service":"CppService"}],"waitForReady":"true"}]}}]',
      type: TXT}      
# Tests for which we also exercise the resolver's ability to skip past a broken DNS server in its nameserver list
- expected_addrs:
  - {address: '5.5.5.5:443', is_balancer: false}
  expected_chosen_service_config: null
  expected_service_config_error: null
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: true
  record_to_resolve: no-srv-ipv4-single-target-inject-broken-nameservers
  records:
    no-srv-ipv4-single-target-inject-broken-nameservers:
    - {TTL: '2100', data: 5.5.5.5, type: A}
- expected_addrs:
  - {address: '1.2.3.4:443', is_balancer: false}
  expected_chosen_service_config: '{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooTwo","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooThree","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooFour","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooFive","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooSix","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooSeven","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooEight","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooNine","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooTen","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooEleven","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooTwelve","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooTwelve","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooTwelve","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooTwelve","service":"SimpleService","waitForReady":true}]}]}'
  expected_service_config_error: 'Service config parsing error'
  expected_lb_policy: null
  enable_srv_queries: true
  enable_txt_queries: true
  inject_broken_nameserver_list: true
  record_to_resolve: ipv4-config-causing-fallback-to-tcp-inject-broken-nameservers
  records:
    ipv4-config-causing-fallback-to-tcp-inject-broken-nameservers:
    - {TTL: '2100', data: 1.2.3.4, type: A}
    _grpc_config.ipv4-config-causing-fallback-to-tcp-inject-broken-nameservers:
    - {TTL: '2100', data: 'grpc_config=[{"serviceConfig":{"loadBalancingPolicy":"round_robin","methodConfig":[{"name":[{"method":"Foo","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooTwo","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooThree","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooFour","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooFive","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooSix","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooSeven","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooEight","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooNine","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooTen","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooEleven","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooTwelve","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooTwelve","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooTwelve","service":"SimpleService","waitForReady":true}]},{"name":[{"method":"FooTwelve","service":"SimpleService","waitForReady":true}]}]}}]',
      type: TXT}
